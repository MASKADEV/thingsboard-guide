#### 环境准备

- JDK11
- Maven3.2.1+
- release-3.6分支

#### 获取代码

```shell
##get source from mirror
git clone https://gitclone.com/github.com/thingsboard/thingsboard

##cd to source path
cd thingsboard

##reset remote 
git remote set-url origin https://github.com/thingsboard/thingsboard.git

##checkout branch 修改分支可适用于更高版本
git checkout -b release-3.6 origin/release-3.6
```


#### 设置代理

##### maven设置
```
vim ~/.m2/settings.xml
```
mirror内增加如下：
```
<mirror>
 <id>alimaven</id>
 <mirrorOf>*</mirrorOf>
 <name>aliyun maven</name>
 <url>http://maven.aliyun.com/nexus/content/repositories/central/</url>
</mirror>
```
##### yarn设置

* 方法一（如果已经安装）

```
yarn config set registry https://registry.npm.taobao.org
```

* 方法二 

```
touch ~/.yarnrc && vim ~/yarnrc
```
增加如下内容
```
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


registry "https://registry.npm.taobao.org"
lastUpdateCheck 1614096367682                           
```

  

#### 编译
```
mvn clean package -DskipTests=true
```
控制台输出
```
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary for Thingsboard 3.6.1:
[INFO] 
[INFO] Thingsboard ........................................ SUCCESS [  0.123 s]
[INFO] Thingsboard Server Commons ......................... SUCCESS [  0.003 s]
[INFO] Thingsboard Server Common Data ..................... SUCCESS [ 15.014 s]
[INFO] Thingsboard Server Common Utils .................... SUCCESS [  1.738 s]
[INFO] Netty MQTT Client .................................. SUCCESS [  2.071 s]
[INFO] Thingsboard Server Common Messages ................. SUCCESS [  2.781 s]
[INFO] Thingsboard Actor system ........................... SUCCESS [  0.869 s]
[INFO] Thingsboard Server Stats ........................... SUCCESS [  0.452 s]
[INFO] Thingsboard Server Common Cluster API .............. SUCCESS [ 14.044 s]
[INFO] Thingsboard Server Queue components ................ SUCCESS [  3.969 s]
[INFO] Thingsboard Server Common Cache .................... SUCCESS [  1.054 s]
[INFO] Thingsboard Server Commons ......................... SUCCESS [  0.001 s]
[INFO] Thingsboard Server Common Transport components ..... SUCCESS [  3.415 s]
[INFO] Thingsboard MQTT Transport Common .................. SUCCESS [  4.791 s]
[INFO] Thingsboard HTTP Transport Common .................. SUCCESS [  0.634 s]
[INFO] Thingsboard CoAP server ............................ SUCCESS [  0.658 s]
[INFO] Thingsboard CoAP Transport Common .................. SUCCESS [  3.940 s]
[INFO] Thingsboard LwM2M Transport Common ................. SUCCESS [  3.107 s]
[INFO] Thingsboard SNMP Transport Common .................. SUCCESS [  1.076 s]
[INFO] Thingsboard Server Common DAO API .................. SUCCESS [  1.067 s]
[INFO] Thingsboard Server Remote Edge wrapper ............. SUCCESS [  5.810 s]
[INFO] Thingsboard Server Version Control API ............. SUCCESS [  0.842 s]
[INFO] Thingsboard Script Invoke Commons .................. SUCCESS [  0.001 s]
[INFO] Thingsboard Server Script invoke API ............... SUCCESS [  1.184 s]
[INFO] Thingsboard Extensions ............................. SUCCESS [  0.001 s]
[INFO] Thingsboard Rule Engine API ........................ SUCCESS [  1.037 s]
[INFO] Thingsboard Server JS Client for remote JS execution SUCCESS [  0.560 s]
[INFO] Thingsboard Server DAO Layer ....................... SUCCESS [ 13.211 s]
[INFO] Thingsboard Rule Engine Components ................. SUCCESS [  7.048 s]
[INFO] Thingsboard Server Transport Modules ............... SUCCESS [  0.002 s]
[INFO] Thingsboard HTTP Transport Service ................. SUCCESS [ 36.312 s]
[INFO] Thingsboard MQTT Transport Service ................. SUCCESS [ 24.758 s]
[INFO] Thingsboard CoAP Transport Service ................. SUCCESS [ 22.406 s]
[INFO] Thingsboard LwM2m Transport Service ................ SUCCESS [ 23.058 s]
[INFO] Thingsboard SNMP Transport Service ................. SUCCESS [ 23.066 s]
[INFO] ThingsBoard Server UI .............................. SUCCESS [02:09 min]
[INFO] Thingsboard Server Tools ........................... SUCCESS [  1.215 s]
[INFO] Thingsboard Rest Client ............................ SUCCESS [  1.482 s]
[INFO] ThingsBoard Server Application ..................... SUCCESS [01:23 min]
[INFO] ThingsBoard Microservices .......................... SUCCESS [  0.060 s]
[INFO] ThingsBoard Docker Images .......................... SUCCESS [  1.089 s]
[INFO] ThingsBoard Web UI Microservice .................... SUCCESS [ 48.626 s]
[INFO] ThingsBoard Version Control Executor ............... SUCCESS [ 21.204 s]
[INFO] ThingsBoard Version Control Executor Microservice .. SUCCESS [  0.183 s]
[INFO] ThingsBoard Node Microservice ...................... SUCCESS [  1.066 s]
[INFO] ThingsBoard Transport Microservices ................ SUCCESS [  0.002 s]
[INFO] ThingsBoard MQTT Transport Microservice ............ SUCCESS [  0.678 s]
[INFO] ThingsBoard HTTP Transport Microservice ............ SUCCESS [  0.496 s]
[INFO] ThingsBoard COAP Transport Microservice ............ SUCCESS [  0.511 s]
[INFO] ThingsBoard LWM2M Transport Microservice ........... SUCCESS [  0.560 s]
[INFO] ThingsBoard SNMP Transport Microservice ............ SUCCESS [  1.009 s]
[INFO] ThingsBoard JavaScript Executor Microservice ....... SUCCESS [ 49.165 s]
[INFO] ThingsBoard Monitoring Service ..................... SUCCESS [ 10.585 s]
[INFO] ThingsBoard Monitoring Microservice ................ SUCCESS [  0.076 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  09:32 min
[INFO] Finished at: 2023-12-19T23:24:07+08:00
[INFO] ------------------------------------------------------------------------
```


#### TIPS
- Thingsboard 总体工程使用maven进行项目生命周期管理，gradle、node、yarn等都是使用maven插件进行初始化
- Yarn代理也有其他的方式可以尝试
```
方式1 ： 修改子工程pom.xml
<execution>
    <id>yarn install</id>
    <goals>
    <goal>yarn</goal>
    </goals>
    <configuration>
    <arguments>install --registry https://registry.npm.taobao.org</arguments>
    </configuration>
</execution>
方式2，在子工程下增加配置文件（可以尝试）
```
- 编译UI时，提示TLS错误，是因为部分依赖存储在github中，而github在2018年后仅支持TLS1.2协议，因此更新git客户端，然后设置TLS版本
```
git config --global --add http.sslVersion tlsv1.2
```
-  [官方编译文档](https://thingsboard.io/docs/user-guide/install/building-from-source/)

